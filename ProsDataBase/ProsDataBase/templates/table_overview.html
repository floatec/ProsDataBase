{% extends "base.html" %}

{% block navigation %}
<div>tables</div>
<ul id="navigationMenuContent">

</ul>

{% endblock %}

{% block header %}

{% endblock %}

{% block menu %}
<a href="/createTable/" id='createTableButton' class="buttonMenuButton">new table</a>

{% endblock %}

{% block javascript %}
<script language="JavaScript">
 $.getJSON('/api/category/', function (data) {
        createTables(data.categories);


        });



    //function to create and fill tables
    function createTables(categories) {

               allCatagories = categories;

            $.getJSON('/api/table/', function (tabledata) {
               for (var i in allCatagories) {


                var tables = tabledata.tables

                var content="";
                var isInCategory = false;
                for (var key in tables) {

                    if (allCatagories[i] == tables[key].category) {
                         isInCategory = true;
                        if (isInCategory){
                            var content = "<span class='categoryHeadline'>"+allCatagories[i]+":</span><br /><br /><div class='"+allCatagories[i]+"'>";
                        }

                        var tablename = tables[key].name;
                        // fill Navigation-Bar
                        $("#navigationMenuContent").append("<li><a href='/detailview/" + tables[key].name + "'>" + tables[key].name + "</a></li>");
                        // create tables

                        content+="<a href='/detailview/" + tables[key].name + "'><div class='overViewDiv' id='table" + key + "'>";
                        content += "<div id='overViewHeader'>" + tablename + "</div>";
                        for (var rows in tables[key].columns) {
                           content+="<div class='overViewContentDiv'>" + tables[key].columns[rows] + "</div>";
                        }
                        content += "</div></a>";

                    }
                }
                content+="</div>";
                $("#content").append(content);



   }
        });

    }
</script>
{% endblock %}